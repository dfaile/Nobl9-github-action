# Nobl9 Template Examples and Expected Outputs

This document provides comprehensive examples of the YAML files generated by the Nobl9 Backstage template and the expected outputs from the GitHub Action.

## Overview

The Nobl9 Backstage template generates several files that work together to create and manage Nobl9 projects. This guide shows you what these files look like and how they're processed by the GitHub Action.

## Template Input Examples

### Basic Project Creation

**Template Parameters:**
```yaml
projectName: "my-web-application"
projectDescription: "Production web application with monitoring and alerting"
projectOwner: "alice@company.com"
projectTeam: "web-team"
projectEnvironment: "production"
projectLabels:
  - "web"
  - "frontend"
  - "production"
projectAnnotations:
  cost-center: "engineering"
  business-unit: "product"
```

### Advanced Project Creation

**Template Parameters:**
```yaml
projectName: "data-pipeline-platform"
projectDescription: "Real-time data processing pipeline with ML models"
projectOwner: "bob@company.com"
projectTeam: "data-engineering"
projectEnvironment: "production"
projectLabels:
  - "data"
  - "ml"
  - "pipeline"
  - "kafka"
  - "spark"
projectAnnotations:
  cost-center: "data-science"
  business-unit: "analytics"
  compliance: "gdpr"
  data-classification: "confidential"
```

## Generated Files Examples

### 1. Nobl9 Project Configuration (`nobl9-project.yaml`)

#### Basic Project Example

```yaml
apiVersion: n9/v1alpha
kind: Project
metadata:
  name: my-web-application
  displayName: My Web Application
  description: Production web application with monitoring and alerting
  labels:
    environment: production
    team: web-team
    web: "true"
    frontend: "true"
    production: "true"
  annotations:
    cost-center: engineering
    business-unit: product
    created-by: backstage-template
    created-at: "2024-01-15T10:30:00Z"
spec:
  description: Production web application with monitoring and alerting
  owner: alice@company.com
  team: web-team
  environment: production
  settings:
    retention:
      days: 30
    alerting:
      enabled: true
      channels:
        - email
        - slack
    monitoring:
      enabled: true
      metrics:
        - response_time
        - error_rate
        - throughput
```

#### Advanced Project Example

```yaml
apiVersion: n9/v1alpha
kind: Project
metadata:
  name: data-pipeline-platform
  displayName: Data Pipeline Platform
  description: Real-time data processing pipeline with ML models
  labels:
    environment: production
    team: data-engineering
    data: "true"
    ml: "true"
    pipeline: "true"
    kafka: "true"
    spark: "true"
  annotations:
    cost-center: data-science
    business-unit: analytics
    compliance: gdpr
    data-classification: confidential
    created-by: backstage-template
    created-at: "2024-01-15T14:45:00Z"
spec:
  description: Real-time data processing pipeline with ML models
  owner: bob@company.com
  team: data-engineering
  environment: production
  settings:
    retention:
      days: 90
    alerting:
      enabled: true
      channels:
        - email
        - slack
        - pagerduty
    monitoring:
      enabled: true
      metrics:
        - processing_latency
        - data_quality_score
        - model_accuracy
        - throughput
        - error_rate
    compliance:
      gdpr: true
      data_retention: 90
```

### 2. Backstage Catalog Information (`catalog-info.yaml`)

#### Basic Project Example

```yaml
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: my-web-application
  description: Production web application with monitoring and alerting
  annotations:
    github.com/project-slug: company/my-web-application
    backstage.io/techdocs-ref: dir:.
    backstage.io/source-location: url:https://github.com/company/my-web-application
    nobl9.io/project-id: my-web-application
    nobl9.io/project-owner: alice@company.com
    nobl9.io/project-team: web-team
    nobl9.io/project-environment: production
  tags:
    - web
    - frontend
    - production
    - nobl9
  links:
    - url: https://app.nobl9.com/projects/my-web-application
      title: Nobl9 Project
      icon: monitoring
    - url: https://github.com/company/my-web-application
      title: Source Code
      icon: github
spec:
  type: service
  lifecycle: production
  owner: web-team
  system: web-platform
  dependsOn:
    - resource:nobl9-platform
  providesApis: []
  consumesApis: []
```

#### Advanced Project Example

```yaml
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: data-pipeline-platform
  description: Real-time data processing pipeline with ML models
  annotations:
    github.com/project-slug: company/data-pipeline-platform
    backstage.io/techdocs-ref: dir:.
    backstage.io/source-location: url:https://github.com/company/data-pipeline-platform
    nobl9.io/project-id: data-pipeline-platform
    nobl9.io/project-owner: bob@company.com
    nobl9.io/project-team: data-engineering
    nobl9.io/project-environment: production
    nobl9.io/compliance: gdpr
    nobl9.io/data-classification: confidential
  tags:
    - data
    - ml
    - pipeline
    - kafka
    - spark
    - nobl9
    - gdpr
  links:
    - url: https://app.nobl9.com/projects/data-pipeline-platform
      title: Nobl9 Project
      icon: monitoring
    - url: https://github.com/company/data-pipeline-platform
      title: Source Code
      icon: github
    - url: https://grafana.company.com/d/data-pipeline
      title: Grafana Dashboard
      icon: dashboard
spec:
  type: service
  lifecycle: production
  owner: data-engineering
  system: data-platform
  dependsOn:
    - resource:nobl9-platform
    - resource:kafka-cluster
    - resource:spark-cluster
  providesApis:
    - data-pipeline-api
  consumesApis:
    - kafka-api
    - ml-model-api
```

### 3. Project README (`README.md`)

#### Basic Project Example

```markdown
# My Web Application

Production web application with monitoring and alerting.

## Project Information

- **Project ID:** `my-web-application`
- **Owner:** alice@company.com
- **Team:** web-team
- **Environment:** production
- **Created:** 2024-01-15T10:30:00Z

## Nobl9 Integration

This project is monitored and managed through Nobl9.

### Nobl9 Project
- **Project URL:** [https://app.nobl9.com/projects/my-web-application](https://app.nobl9.com/projects/my-web-application)
- **Monitoring:** Enabled
- **Alerting:** Enabled (Email, Slack)
- **Retention:** 30 days

### Key Metrics
- Response Time
- Error Rate
- Throughput

## Quick Links

- [Nobl9 Project Dashboard](https://app.nobl9.com/projects/my-web-application)
- [Source Code](https://github.com/company/my-web-application)
- [Backstage Component](https://backstage.company.com/catalog/default/component/my-web-application)

## Team

- **Owner:** alice@company.com
- **Team:** web-team

## Labels

- environment: production
- team: web-team
- web: true
- frontend: true
- production: true

## Annotations

- cost-center: engineering
- business-unit: product

---

*This project was created using the Nobl9 Backstage template.*
```

#### Advanced Project Example

```markdown
# Data Pipeline Platform

Real-time data processing pipeline with ML models.

## Project Information

- **Project ID:** `data-pipeline-platform`
- **Owner:** bob@company.com
- **Team:** data-engineering
- **Environment:** production
- **Created:** 2024-01-15T14:45:00Z
- **Compliance:** GDPR
- **Data Classification:** Confidential

## Nobl9 Integration

This project is monitored and managed through Nobl9.

### Nobl9 Project
- **Project URL:** [https://app.nobl9.com/projects/data-pipeline-platform](https://app.nobl9.com/projects/data-pipeline-platform)
- **Monitoring:** Enabled
- **Alerting:** Enabled (Email, Slack, PagerDuty)
- **Retention:** 90 days
- **Compliance:** GDPR enabled

### Key Metrics
- Processing Latency
- Data Quality Score
- Model Accuracy
- Throughput
- Error Rate

## Quick Links

- [Nobl9 Project Dashboard](https://app.nobl9.com/projects/data-pipeline-platform)
- [Source Code](https://github.com/company/data-pipeline-platform)
- [Grafana Dashboard](https://grafana.company.com/d/data-pipeline)
- [Backstage Component](https://backstage.company.com/catalog/default/component/data-pipeline-platform)

## Team

- **Owner:** bob@company.com
- **Team:** data-engineering

## Labels

- environment: production
- team: data-engineering
- data: true
- ml: true
- pipeline: true
- kafka: true
- spark: true

## Annotations

- cost-center: data-science
- business-unit: analytics
- compliance: gdpr
- data-classification: confidential

## Dependencies

- Nobl9 Platform
- Kafka Cluster
- Spark Cluster

## APIs

### Provides
- data-pipeline-api

### Consumes
- kafka-api
- ml-model-api

---

*This project was created using the Nobl9 Backstage template.*
```

## GitHub Action Processing Examples

### 1. Action Input and Configuration

#### Basic Action Usage

```yaml
# .github/workflows/nobl9-deploy.yml
name: Nobl9 Project Deployment

on:
  push:
    branches: [main]
    paths:
      - 'projects/**/*.yaml'
      - 'projects/**/*.yml'

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Deploy to Nobl9
        uses: your-org/nobl9-action@v1
        with:
          client-id: ${{ secrets.NOBL9_CLIENT_ID }}
          client-secret: ${{ secrets.NOBL9_CLIENT_SECRET }}
          organization: ${{ secrets.NOBL9_ORGANIZATION }}
          environment: ${{ secrets.NOBL9_ENVIRONMENT }}
```

#### Advanced Action Usage

```yaml
# .github/workflows/nobl9-deploy.yml
name: Nobl9 Project Deployment

on:
  push:
    branches: [main, develop]
    paths:
      - 'projects/**/*.yaml'
      - 'projects/**/*.yml'
  workflow_dispatch:
    inputs:
      dry_run:
        description: 'Run in dry-run mode'
        required: false
        default: 'false'
        type: boolean

jobs:
  deploy:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Deploy to Nobl9
        uses: your-org/nobl9-action@v1
        with:
          client-id: ${{ secrets.NOBL9_CLIENT_ID }}
          client-secret: ${{ secrets.NOBL9_CLIENT_SECRET }}
          organization: ${{ secrets.NOBL9_ORGANIZATION }}
          environment: ${{ secrets.NOBL9_ENVIRONMENT }}
          dry-run: ${{ github.event.inputs.dry_run || 'false' }}
          timeout: '60s'
          retry-attempts: '5'
          log-level: 'info'
        env:
          NOBL9_DEBUG: 'true'
          NOBL9_LOG_LEVEL: 'info'
```

### 2. Action Output Examples

#### Successful Deployment Output

```json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "level": "info",
  "message": "Nobl9 project deployment completed successfully",
  "project": "my-web-application",
  "action": "created",
  "duration": "2.5s",
  "files_processed": 1,
  "users_resolved": 1,
  "role_bindings_created": 2,
  "details": {
    "project_created": true,
    "owner_assigned": true,
    "team_members_added": ["alice@company.com"],
    "role_bindings": [
      {
        "name": "my-web-application-owner",
        "role": "Owner",
        "user": "alice@company.com",
        "status": "created"
      },
      {
        "name": "my-web-application-admin",
        "role": "Admin",
        "user": "alice@company.com",
        "status": "created"
      }
    ]
  }
}
```

#### Dry-Run Validation Output

```json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "level": "info",
  "message": "Dry-run validation completed",
  "project": "data-pipeline-platform",
  "action": "validated",
  "duration": "1.2s",
  "files_processed": 1,
  "validation_results": {
    "yaml_valid": true,
    "project_config_valid": true,
    "user_resolution": {
      "bob@company.com": {
        "resolved": true,
        "user_id": "okta-user-12345",
        "status": "active"
      }
    },
    "role_bindings_valid": true,
    "compliance_check": {
      "gdpr_compliant": true,
      "data_retention_valid": true
    }
  }
}
```

#### Error Output Example

```json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "level": "error",
  "message": "Failed to create Nobl9 project",
  "project": "invalid-project",
  "action": "failed",
  "duration": "5.1s",
  "error": {
    "type": "validation_error",
    "code": "INVALID_PROJECT_NAME",
    "message": "Project name 'invalid-project' contains invalid characters",
    "details": {
      "field": "metadata.name",
      "value": "invalid-project",
      "constraint": "DNS RFC1123 compliant name required"
    }
  },
  "files_processed": 1,
  "users_resolved": 0,
  "role_bindings_created": 0
}
```

### 3. User Resolution Examples

#### Successful User Resolution

```json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "level": "info",
  "message": "User resolved successfully",
  "email": "alice@company.com",
  "user_id": "okta-user-12345",
  "resolved": true,
  "duration": "0.8s",
  "cache_hit": false,
  "details": {
    "username": "okta-user-12345",
    "full_name": "Alice Johnson",
    "active": true,
    "source": "okta"
  }
}
```

#### User Not Found

```json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "level": "warn",
  "message": "User not found in Okta",
  "email": "unknown@company.com",
  "user_id": "",
  "resolved": false,
  "duration": "1.2s",
  "cache_hit": false,
  "details": {
    "error": "User not found in Okta directory",
    "suggestion": "Verify email address or contact IT team"
  }
}
```

## File Processing Examples

### 1. Single Project Processing

**Input Directory Structure:**
```
projects/
└── my-web-application/
    ├── nobl9-project.yaml
    ├── catalog-info.yaml
    └── README.md
```

**Processing Output:**
```json
{
  "files_scanned": 3,
  "files_processed": 1,
  "files_skipped": 2,
  "processing_summary": {
    "nobl9_projects": 1,
    "catalog_info": 1,
    "readme": 1
  },
  "validation_results": {
    "yaml_valid": true,
    "project_config_valid": true,
    "catalog_info_valid": true
  }
}
```

### 2. Multiple Projects Processing

**Input Directory Structure:**
```
projects/
├── my-web-application/
│   ├── nobl9-project.yaml
│   ├── catalog-info.yaml
│   └── README.md
├── data-pipeline-platform/
│   ├── nobl9-project.yaml
│   ├── catalog-info.yaml
│   └── README.md
└── mobile-app/
    ├── nobl9-project.yaml
    ├── catalog-info.yaml
    └── README.md
```

**Processing Output:**
```json
{
  "files_scanned": 9,
  "files_processed": 3,
  "files_skipped": 6,
  "processing_summary": {
    "nobl9_projects": 3,
    "catalog_info": 3,
    "readme": 3
  },
  "projects_created": [
    "my-web-application",
    "data-pipeline-platform",
    "mobile-app"
  ],
  "users_resolved": 3,
  "role_bindings_created": 6,
  "total_duration": "8.5s"
}
```

## Validation Examples

### 1. YAML Validation

#### Valid YAML
```yaml
apiVersion: n9/v1alpha
kind: Project
metadata:
  name: valid-project
  displayName: Valid Project
spec:
  description: A valid project configuration
```

**Validation Result:**
```json
{
  "valid": true,
  "errors": [],
  "warnings": []
}
```

#### Invalid YAML
```yaml
apiVersion: n9/v1alpha
kind: Project
metadata:
  name: invalid project name
  displayName: Invalid Project
spec:
  description: An invalid project configuration
```

**Validation Result:**
```json
{
  "valid": false,
  "errors": [
    {
      "field": "metadata.name",
      "message": "Project name contains invalid characters",
      "value": "invalid project name"
    }
  ],
  "warnings": []
}
```

### 2. Project Configuration Validation

#### Valid Configuration
```yaml
apiVersion: n9/v1alpha
kind: Project
metadata:
  name: valid-project
  displayName: Valid Project
  labels:
    environment: production
    team: engineering
spec:
  description: A valid project configuration
  owner: alice@company.com
  team: engineering
  environment: production
```

**Validation Result:**
```json
{
  "valid": true,
  "required_fields": {
    "apiVersion": "present",
    "kind": "present",
    "metadata.name": "present",
    "metadata.displayName": "present",
    "spec.description": "present",
    "spec.owner": "present"
  },
  "optional_fields": {
    "metadata.labels": "present",
    "spec.team": "present",
    "spec.environment": "present"
  }
}
```

#### Invalid Configuration
```yaml
apiVersion: n9/v1alpha
kind: Project
metadata:
  name: invalid-project
spec:
  # Missing required fields
```

**Validation Result:**
```json
{
  "valid": false,
  "errors": [
    {
      "field": "metadata.displayName",
      "message": "Display name is required",
      "type": "missing_required_field"
    },
    {
      "field": "spec.description",
      "message": "Description is required",
      "type": "missing_required_field"
    },
    {
      "field": "spec.owner",
      "message": "Owner is required",
      "type": "missing_required_field"
    }
  ],
  "warnings": []
}
```

## Error Handling Examples

### 1. API Authentication Error

```json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "level": "error",
  "message": "Authentication failed",
  "error": {
    "type": "authentication_error",
    "code": "INVALID_CREDENTIALS",
    "message": "Invalid client ID or secret",
    "retryable": false,
    "suggestion": "Verify NOBL9_CLIENT_ID and NOBL9_CLIENT_SECRET"
  }
}
```

### 2. API Rate Limit Error

```json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "level": "warn",
  "message": "Rate limit exceeded, retrying",
  "error": {
    "type": "rate_limit_error",
    "code": "RATE_LIMIT_EXCEEDED",
    "message": "Too many requests",
    "retryable": true,
    "retry_after": "60s",
    "attempt": 1,
    "max_attempts": 3
  }
}
```

### 3. Network Timeout Error

```json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "level": "error",
  "message": "Request timeout",
  "error": {
    "type": "network_error",
    "code": "TIMEOUT",
    "message": "Request timed out after 30s",
    "retryable": true,
    "attempt": 2,
    "max_attempts": 3
  }
}
```

## Performance Examples

### 1. Processing Time Metrics

```json
{
  "performance_metrics": {
    "total_duration": "12.5s",
    "file_scanning": "0.3s",
    "yaml_parsing": "0.8s",
    "user_resolution": "5.2s",
    "api_calls": "6.2s",
    "files_per_second": 2.4,
    "users_per_second": 0.8
  },
  "resource_usage": {
    "memory_peak": "45MB",
    "cpu_usage": "12%",
    "network_requests": 15,
    "cache_hits": 3,
    "cache_misses": 7
  }
}
```

### 2. Scalability Examples

#### Small Project (1-5 files)
```json
{
  "files_processed": 3,
  "duration": "3.2s",
  "users_resolved": 2,
  "projects_created": 1
}
```

#### Medium Project (5-20 files)
```json
{
  "files_processed": 12,
  "duration": "8.7s",
  "users_resolved": 8,
  "projects_created": 4
}
```

#### Large Project (20+ files)
```json
{
  "files_processed": 35,
  "duration": "18.3s",
  "users_resolved": 25,
  "projects_created": 12
}
```

## Best Practices Examples

### 1. Recommended Project Structure

```
projects/
├── project-name/
│   ├── nobl9-project.yaml      # Nobl9 project configuration
│   ├── catalog-info.yaml       # Backstage catalog information
│   ├── README.md              # Project documentation
│   └── .gitignore             # Git ignore rules
├── another-project/
│   ├── nobl9-project.yaml
│   ├── catalog-info.yaml
│   └── README.md
└── shared/
    ├── common-labels.yaml      # Shared label definitions
    └── team-configs.yaml       # Team-specific configurations
```

### 2. Consistent Naming Conventions

```yaml
# Good examples
projectName: "web-frontend"
projectName: "data-pipeline-v2"
projectName: "mobile-app-ios"

# Avoid these
projectName: "Web Frontend"        # Spaces and uppercase
projectName: "data_pipeline_v2"    # Underscores
projectName: "mobile-app.ios"      # Dots
projectName: "123-project"         # Starts with number
```

### 3. Comprehensive Labels and Annotations

```yaml
projectLabels:
  - "web"
  - "frontend"
  - "production"
  - "team-web"
  - "cost-center-engineering"

projectAnnotations:
  cost-center: "engineering"
  business-unit: "product"
  compliance: "sox"
  data-classification: "public"
  team-lead: "alice@company.com"
  slack-channel: "#web-team"
  jira-project: "WEB"
```

---

*These examples demonstrate the complete workflow from template input to final deployment. Use them as references for creating your own Nobl9 projects and understanding the expected outputs.* 